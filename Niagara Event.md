A Niagara Event is used to communicate from one [[Niagara Emitter]] to another.
The event can carry data.

Events are generated by the sending Emitter by a [[Niagara Module]] and are handled by the receiving Emitter by another Module.


# Sending Event

Send an event by adding an `<TYPE> Write` node to the sending [[Niagara Module]] by right-click  and select `Add <TYPE> Event Write`.
`<TYPE>` is the type to include in the event payload.
(
I think this is what is called a "Payload", as opposed to "Parameter",  in [[Project Settings]] > Plugins > Niagara.
)
If `<TYPE>` is a [[Blueprint Structure]] then it must first be registered in [[Project Settings]] > Plugins > Niagara > Additional Payload Types.
Hook the execution pins up so that the new node is reached when traversing from the Input Map node to the Output Module node.

The Write node provide input pins for the members in the type being sent, which is used to populate it with data.
Wires can be connected directly from the Write node to the Map Get node to create Module input parameters of the appropriate type.
The input variables can be renamed by double-clicking the name in the Map Get node and typing the new name.
The input variables show up in the Selection panel when an instance of the Module is selected in a [[Niagara Emitter]].


# Receiving Event

Receive an even by adding an `<TYPE> Read` node to the receiving [[Niagara Module]] by right-click and select `Add <TYPE> Event Read`.
Connect the execution pins.
The Read node provides an output pin for each member of the type received.

# Event Handler

A [[Niagara Emitter]] may have event handling [[Niagara Module]]s in the Event Handler stage.
The Event Handler stage is added with the + Stage button at the top of the [[Niagara Emitter]]'s node in the [[Niagara Editor]].
The Selection panel will show the Event Handler Properties where we can chose which event source we want to handle.
It will list all event generator [[Niagara Module]]s that exists in the [[Niagara System]].

The Event Handler stage can have Receive Modules, such as
- Receive Collision Event
- Receive Death Event
- Receive Location Event

## Receive Death Event

An Event Handler [[Niagara Module]] that listens for death events.
The death event comes with a payload:
- Vector 1: Position.
- Vector 2: Velocity.
- Vector 3: Acceleration.
- Float: Random Normalized Float.
- Linear Color: Color.
- Niagara ID: Ribbon ID.
- Bo...? : Coordinate Space Transform.

The Receive Death Event [[Niagara Module]] can either Apply or Output each payload member.

By default the Receive Death Event takes the Position from the death event and it to the owning Emitter.
I think it moves all the particles to the payload location.
I think it does `PARTICLES > Position = Death Event > Location`.

The alternative to Apply is Output.
This writes the death event payload value to a temporary variable that [[Niagara Module]]s in the Event Handler stage can read.
On any [[Niagara Module]] that has a parameter of the correct type we can click the âŒµ button on the far-right of the Selection panel with the Module selected and find Link Inputs > Output > OUTPUT > RECEIVE DEATH EVENT > payload member.

The death event carries the location as a Vector and not a Position.
Use a Convert Vector To Position [[Niagara Dynamic Parameter]] to convert it.
Then bind to OUTPUT > RECEIVE DEATH EVENT > Vector_1.
We don't see user-friendly names here, so consult the list above for which payload member corresponds to which data.

# Blueprint Structure

The data can be defined by a [[Blueprint Structure]].
I'm not sure what the limitations on members of the structure are.
The new type must be registered at [[Project Settings]] > Plugins > Niagara > Additional Parameter Types and Additional Payload Types.
I don't know what the difference between a Parameter and a Payload is yet.


# Generate Location Event

A [[Niagara Emitter]] can generate events that contain the location of each particle.
This is done with the Generate Location Event [[Niagara Module]].
This Module can be added to the Particle Update stage to continuously generate location updates.
This is useful when using the [[Niagara Ribbon Renderer]].
One particle system, called the Ribbon Trail Leader, simulate a particle that represents the start of the trail.
It has a Generate Location Event [[Niagara Module]] in Particle Update.
Another [[Niagara Emitter]] listens for these events and uses a [[Niagara Ribbon Renderer]] to render the path that the leader particle took.


# Generate Death Event

Event that is generated when a particle reaches the end of  its life.
This requires that Requires Persistent IDs is enabled at [[Niagara Editor]] > Emitter node > Properties > Selection panel > Emitter > Requires Persistent IDs.


# References

- [_Unreal Engine 4.26.0 Niagara Growing Trees Tutorial_ by Art Hiteca @ youtube.com 2022](https://www.youtube.com/watch?v=DV1cPrYHtYg)
- [_Intro To Niagara_ by Epic Online Learning, James Hill @ dev.epicgames.com/tutorials 2023 UE5.2](https://dev.epicgames.com/community/learning/tutorials/8B1P/unreal-engine-intro-to-niagara)

